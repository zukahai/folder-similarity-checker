import json
import random
import codecs
from docx import Document
import pandas as pd
import math
from PIL import Image

class Util:
    def __init__(self):
        pass

    @staticmethod
    def read_file(path):
        try:
            if (Util.is_word_file(path)):
                return Util.read_word_file(path)
            if (Util.is_excel_file(path)):
                return Util.read_excel_file(path)
            if (Util.is_image_file(path)):
                return Util.read_image(path)
            return Util.read_file_default(path)
        except:
            return ""
    
    @staticmethod
    def read_file_default(path):
        with codecs.open(path, 'r', encoding='utf-8') as file:
            java_code = file.read()
        return java_code


    @staticmethod
    def read_word_file(path):
        doc = Document(path)
        text = ""
        for paragraph in doc.paragraphs:
            text += paragraph.text + "\n"
        return text
    
    def read_excel_file(excel_file):
        try:
            df = pd.read_excel(excel_file)
            text_data = df.to_string(index=False, header=False)
            return text_data
        except Exception as e:
            return str(e)
        
    def read_image(image_path, step=1):
        try:
            img = Image.open(image_path)
            width, height = img.size
            pixel_matrix = []
            length_taget = 5000
            step = 1 if math.sqrt((width * height) // length_taget) < 1 else math.sqrt((width * height) // length_taget)
            step = (int) (step)
            for y in range(0, height, step):
                for x in range(0, width, step):
                    pixel = img.getpixel((x, y))
                    pixel_value = int(''.join(map(str, pixel)))
                    pixel_matrix.append(pixel_value)

            matrix_text = ' '.join(map(str, pixel_matrix))
            return matrix_text
        except Exception as e:
            print(e)
            return str(e)

    @staticmethod
    def write_json_utf8(path, data):  # Sửa tên biến thành "data"
        with open(path, 'w', encoding='utf-8') as file:
            json.dump(data, file, ensure_ascii=False, indent=4)

    @staticmethod
    def is_word_file(file_path):
        return file_path.lower().endswith(".docx")
    
    @staticmethod
    def is_excel_file(file_path):
        return file_path.lower().endswith((".xls", ".xlsx", ".xlsm", ".xlsb"))
    
    @staticmethod
    def is_image_file(file_path):
        return file_path.lower().endswith((".png", ".jpg", ".jpeg"))

    @staticmethod
    def info():
        #https://patorjk.com/software/taag/
        arr = [0] * 100
        hz_pattern = [
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&#GGPGB&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&P7^:.....:!5&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@B~........... :5@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@B: .:.:7YY?^.:.  JP5YJJJYY5GB#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Y .::.Y@@@&Y  .^~7?JY555YJ?7!~!7JP#@@@@@@@&#BB#&@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@P ..:.~P5!^~JP#&@@@@@@@@@@@@@&#GY!~!Y#&P?~^::::^!JB@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@?  ..  ^JB@@@@@@@@@@@@@@@@@@@@@@@&P7^: .......::..7#@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@P!  ^5&@@@@@@@@@@@@@@@@@@@@@@@@@@@@#Y: .:!??~..:: ~&@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@J.J&@@@@@#BGPGB#@@@@@@@@@@@@@@@@@@@@&? ^G@@@7..:. 5@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&7 5@@@@BJ!:.....:!B@@@@@@@@@@@@@@@@@@@@P.^5&B!.::. P@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@P?~^^~?P&@@@@@@@@@B7^!G@@@B!....^~7^:. !@@@@@@@@&BGGB#@@@@@@@G..^:.:.. 7@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@#~ .^!::. ^G@@@@@@@?.?#@@@@P:..::.~!7^..!B@@@@@@@P^:...:~Y#@@@@@J ...  ^5@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@! .^?Y^5J:..J&@@@@7.P@@@@@@~.::::....:!P@@&@@@@@@^.:^~!^..:Y@@@@#:.~7JG&@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@B. ^57..^^::: ^G@@B ?@@@@@@@?......:!Y#@@@7::~75&@5..~!7^.:..J@@@@^:&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@G ....::..:.::..7#B ?@@@@@@@&57!!?5#@GG@@@#Y!~~?#@@G^.....::.:B@@@^^&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@#: ...::::::..::..!.~@@@@@@@@@@@@@@@@@P?Y5Y?!G@@@@&@&?:..:::.^#@@@!.B@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@5 .::::::::::.:::.. P@@@@@@@@@@@@@@@@@^.... .75GPP&@@B7:...^P@@@@B ?@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@? .:::::::::::.::: :G@@@@@@@@@@@@@@@@7???7~: !B&@@@@@@#P5P&@@@@@&:~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@J  .:::::::::::..  :P@@@@@@@@@@@@@@@G7?JJ?7Y@@@@@@@@@@@@@@@@@@@5 J@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@P: .....:::....  . .?#@@@@@@@@@@@@@@#G5PG&@@@@@@@@@@@@@@@@@@&Y: 7@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@#?. .......... .... :JB@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#5~ ...^?B@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@B7.  ....... ...... :7P#@@@@@@@@@@@@@@@@@@@@@@@@@@@@&GJ^  :::.. .J&@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@#Y~.  .... ........ .^7YG#&@@@@@@@@@@@@@@@@@@@&B5?~.  .::..:::. ~&@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@B57~:.. ..:::......  .^!?Y5GBB######BBGPY?!^:. ....::.::::::. J@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@P  .....:........    ..:::^^::::..  .......:::.:::::::. :&@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@? 77~::............................:::....::..:::::::.. :&@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@#GPYJ?.:P&@&#GP55YYJJ??77!!~^::........:::....:::.:::::::::.. !@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@G?~:::::::::^7G&@@@@@@@@@@@@@@@&#BGPYJ7~~^:....:::.::::::::::... ^?P#@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@G~.:~~:.:::::::..!P#&@@@@@@@@@@@@@@@@@@@@@G!..::::.:::::::::..... .:..:7B@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@P..?#&&BJ^......:..:YGB&@@@@@@@@@@@@@@@@@@Y..:::..::::::::......  .~JPP?.:P@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@~ ^&@@@@@&?..:::::. .YPPGBB##&&&&&&&&@@@@#..:..::::::::......  ..:5@@@@@7.^&@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@! :&@@@@@@@J..:::::. ^PPPPPPPPPPPPPPGGGGBB! ..::::........ .....:G@@@@@@J :&@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@G  5@@@@@@@@!.::::::. JGPPPPPPPPPPPPPPPPPPP7:. ....   .. ...::..P@@@@@@@! !@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@? :G@@@@@@@5.:::::.. !GPPPPPPPPPPPPPPPPPPPGPY?!!!!7?J?...::::.^&@@@@@@Y .B@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@7 .7PGBB#&J........ ~GPPPPPPPPPPPPPPPPPPPPPGGGGGGGGGJ .......~&&&##G?  5@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@Y. :!?JJ7......... !GPPPPPPPPPPPPPPPPPPPPPPPPPPPPPGJ ........!YYJ7: .P@@@@@@@@@@@@@@@@@@@@@@',
            '@@@&@@@@@@@@@@@&&&#BPY?7!!~~~~~!~:^~!!777777!!!!!!!!77777??7777!!~^~~^^^^^^^~!?JP#&&&&&&&&@@@@@@@@@@@@@@@@@@@@@',
            '@&&&&&@@@@@@@@@@@@@@&&&&&&&&&&#BP55YYYYY5555555555YYJJJJJJYY5PG#&&&####&&&&@@&&&&&&&&&&&@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@&&&&&&&&&&&&&@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',
            '@@@@@@B?77P@@@#?775@@@@@@@5777?&@@@@@@#?77P@@G7?????JJ?J&@@577?&@@@P77?#@@@G777B@@G777J#@@@@@@&J777Y@@@@@@@@@@@',
            '@@@@@@&~::P@@@&!::Y@@@@@@#!::::P@@@@@@&~::P@@P^~~~~^:::J@@@Y::!&@@@G::^&@@@B::^#&Y^::J&@@@@@@@G^:::^#@@@@@@@@@@',
            '@@@@@@&~:^P@@@&7::5@@@@@@J:^^^:~#@@@@@&!::P@@&&@@@G^::Y@@@@Y::!&@@@G^:~&@@@B^^^57::!B@@@@@@@@#!:^^^:?@@@@@@@@@@',
            '@@@@@@&~:^!7777^^:5@@@@@G^:^G?::J@@@@@&!::P@@@@@@G~::5@@@@@Y::!&@@@G^:~&@@@B^^^^:^Y&@@@@@@@@@Y::!G~::P@@@@@@@@@',
            '@@@@@@&~:^~!!!!^^:5@@@@&7::7BY^:^G@@@@&!::P@@@@@G~:^5@@@@@@Y::!@@@@G^:~&@@@B^^^::^5@@@@@@@@@B^::JB?::!&@@@@@@@@',
            '@@@@@@&~:^P@@@&7::5@@@@5:^:::::::!&@@@&!::P@@@@G^:^P@@@@@@@5::!#@@@5^:~&@@@B^^^Y!::7#@@@@@@&7:^:::::^:Y@@@@@@@@',
            '@@@@@@&~::P@@@&!::5@@@B~::YBGGP!::Y@@@&~::P@@@P^::~JJJJ?&@@&?::~77!^:^P@@@@B::^#&J^:^5@@@@@5::~PBGG5^:^B@@@@@@@',
            '@@@@@@#7!!P@@@#?!!Y@@&J!!7&@@@@5!!7B@@#7!!5@@#7~~~~~~~~~#@@@@BY7!!!?5#@@@@@G!!!B@@P!!!J#@@B7!!Y@@@@@J!!?&@@@@@@',
            '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@',

        ]


        arr[0] = ('\n'.join(hz_pattern))

        arr[1] = '''
 __ __   ____  ____  _____  __ __  __  _   ____ 
|  |  | /    ||    ||     ||  |  ||  |/ ] /    |
|  |  ||  o  | |  | |__/  ||  |  ||  ' / |  o  |
|  _  ||     | |  | |   __||  |  ||    \\ |     |
|  |  ||  _  | |  | |  /  ||  :  ||     \\|  _  |
|  |  ||  |  | |  | |     ||     ||  .  ||  |  |
|__|__||__|__||____||_____| \__,_||__|\\_||__|__|
'''
        arr[2] = '''
 _   _       _  ______      _         
| | | |     (_)|___  /     | |        
| |_| | __ _ _    / / _   _| | ____ _ 
|  _  |/ _` | |  / / | | | | |/ / _` |
| | | | (_| | |./ /__| |_| |   < (_| |
\_| |_/\__,_|_|\_____/\__,_|_|\_\__,_|
                                      
                                      
'''

        arr[3] = '''
  __    __       __        __   ________   ____  ____  __   ___       __      
 /" |  | "\\     /""\\      |" \\ ("      "\\ ("  _||_ " ||/\"| /  ")     /""\\     
(:  (__)  :)   /    \\     ||  | \\___/   :)|   (  ) : |(: |/   /     /    \\    
 \\/      \\/   /' /\\  \\    |:  |   /  ___/ (:  |  | . )|    __/     /' /\\  \\   
 //  __  \\\\  //  __'  \\   |.  |  //  \\__   \\\\ \\__/ // (// _  \\    //  __'  \\  
(:  (  )  :)/   /  \\\\  \\  /\\  |\\(:   / "\\"  /\\\\ __ //\\|: | \\  \\  /   /  \\\\  \\ 
 \\__|  |__/( __/    \\___)(__\\_|_)\\_______)(__________)(__|  \\__)(___/    \\___)
'''

        arr[4] = '''

    __  __      _ _____         __        
   / / / /___ _(_)__  /  __  __/ /______ _
  / /_/ / __ `/ /  / /  / / / / //_/ __ `/
 / __  / /_/ / /  / /__/ /_/ / ,< / /_/ / 
/_/ /_/\__,_/_/  /____/\__,_/_/|_|\__,_/  
                                          
'''

        arr[5] = '''
 ___   ___   ________    ________    ______  __  __   ___   ___   ________      
/__/\ /__/\ /_______/\  /_______/\  /_____/\/_/\/_/\ /___/\/__/\ /_______/\     
\::\ \\\  \ \\\::: _  \ \ \__.::._\/  \:::__\/\:\ \:\ \\\::.\ \\\ \ \\\::: _  \ \    
 \::\/_\ .\ \\\::(_)  \ \   \::\ \      /: /  \:\ \:\ \\\:: \/_) \ \\\::(_)  \ \   
  \:: ___::\ \\\:: __  \ \  _\::\ \__  /::/___ \:\ \:\ \\\:. __  ( ( \:: __  \ \  
   \: \ \\\::\ \\\:.\ \  \ \/__\::\__/\/_:/____/\\\:\_\:\ \\\: \ )  \ \ \:.\ \  \ \ 
    \__\/ \::\/ \__\/\__\/\________\/\_______\/ \_____\/ \__\/\__\/  \__\/\__\/ 
                                                                                
'''

        print(arr[random.randint(0, 5)])

data = {
    "a": 1
}

